---
title: Troubleshooting
description: Common issues and solutions detected by the users.
---
import ImageComponent from "@components/ImageComponent.astro";
import ThemedImage from '@components/ThemedImage.astro';

This document shows common issues and solutions to any problems a user can meet.

### Installation

#### filesystem `btrfs' doesn't support blocklists

The error during the installation:
```
grub-install: warning: this GPT partition label contains no BIOS Boot Partition; embedding won't be possible.
grub-install: error: filesystem `btrfs' doesn't support blocklists.
```
is caused when the partition table is GPT and you are not using EFI boot mode. If you would like to use GPT, remember to use EFI instead of BIOS/Legacy mode.

### Boot

#### Several boot entries have been disappeared

In case you are in dual boot and some entries are not shown anymore (i.e., Windows Boot Manager if you have Windows in dual boot), enter in Athena OS and run:
```
sudo grub-mkconfig -o /boot/grub/grub.cfg
```
Then reboot.

#### ERROR kdfontop.c:183 put_font_kdfontop: Unable to load such font with such kernel version

The message:
```
setfont: ERROR kdfontop.c:183 put_font_kdfontop: Unable to load such font with such kernel version
```
can be fixed by disabling the deferred takeover by adding `fbcon=nodefer` as kernel parameter in the `GRUB_CMDLINE_LINUX_DEFAULT` variable of **/etc/default/grub** file.
Reference: [#99](https://github.com/legionus/kbd/issues/99)

### Display Managers

#### GDM: login background turned to grey

It should be caused by an update of GDM or GNOME packages that restored the default gresource theme file. To restore the Athena GDM theme, run:
```
sudo pacman -S athena-gdm-config
```

### Tools

#### Bloodhound

On Bloodhound, when neo4j database is run by `sudo neo4j console`, we can get some errors like:
```
Exception in thread "main" java.lang.LinkageError: Cannot to link java.nio.DirectByteBuffer
```
For solving it, just run neo4j server by `systemctl start neo4j`. You can check the proof that the server is correctly running by `systemctl status neo4j`.

#### Conda

`conda activate` continues to show the prompt **(base)** instead of **(test)**.

The issue is related to the usage of `no-repeat-flag` in `.bashrc`. To solve this, add the following code inside `.bashrc`:
```bash
if [[ $1 != no-repeat-flag  ]]; then
    __conda_setup="$('/home/kumquat/miniconda3/bin/conda' 'shell.bash' 'hook' 2> /dev/null)"
    if [ $? -eq 0 ]; then
        eval "$__conda_setup"
    else
        if [ -f "/home/kumquat/miniconda3/etc/profile.d/conda.sh" ]; then
            . "/home/kumquat/miniconda3/etc/profile.d/conda.sh"
        else
            export PATH="/home/kumquat/miniconda3/bin:$PATH"
        fi
    fi
    unset __conda_setup
fi
# <<< conda initialize <<<
conda activate $CONDA_DEFAULT_ENV
```

### WSL

#### Win-Kex ESM Mode
This issue affects both Athena OS and Kali Linux. When you run `kex --esm` and you get:
```
/usr/bin/kex: line 389: /mnt/c/Windows/system32/cmdkey.exe: cannot execute: required file not found
/usr/bin/kex: line 490: /mnt/c/Windows/system32/mstsc.exe: cannot execute: required file not found
```
it could be due to two reasons:
1. wine is installed
2. you are running Athena OS and Kali Linux WSL together

Uninstall wine package, close both the WSL sessions, open CMD in Windows and run `wsl --shutdown`. Run Athena OS and you should not get this error anymore.

### Misc

#### Browser elements overlap

In case it occurs that browser elements can overlap as the following case:
![Website Overlapping](@assets/images/website-overlapping.png)

The reason is that the website is using the Athena OS system font instead of using its one.

In case you would like to solve this behavior on the system side, you need to delete the entry `font-name='JetBrains Mono 11'` set in **/org/gnome/desktop/** or changing its font.
:::caution
If you remove the **font-name** entry, several elements of the desktop (like the top bar) will use the default font. In case you change the font name, the desktop elements will apply it as well.
:::
You can remove it or change the font by:
```
dconf dump /org/gnome/desktop/ > fix.txt
```
Edit **fix.txt** and delete the line containing `font-name='JetBrains Mono 11'` or replace this font name with your preferred, save and close the file, then run:
```
dconf reset -f /org/gnome/desktop/
cat fix.txt | dconf load /org/gnome/desktop/
```
In case your theme will be reset, just run:
```
athena-theme-tweak -t <name of your favourite theme>
```
Use `athena-theme-tweak -l` to get the list of themes to be chosen.

#### Restore system by snapshots in GRUB

In case you are not able to get in the system due to a broken upgrade or similar events, you can leverage on Grub BTRFS snapshots in order to restore a previous state of your system. To do this, run the system, on the GRUB select **Athena OS Snapshots**

![Athena Snapshots](@assets/images/athena-snapshots.png)

Choose the **snapshot** you want to restore

![Athena Snapshots Selection](@assets/images/athena-snapshots-selection.png)

and select the **Linux Kernel** to run

![Athena Snapshots Run](@assets/images/athena-snapshots-run.png)

<ImageComponent />
